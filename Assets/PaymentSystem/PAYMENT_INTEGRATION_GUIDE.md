# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Freedom Pay

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã
**–ü—Ä–æ–±–ª–µ–º–∞**: –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–ª—Å—è –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª URL
**–†–µ—à–µ–Ω–∏–µ**: 
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ `OpenPaymentUrl()` —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
- ‚úÖ –î–ª—è Android –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Intent` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å fallback –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥

### 2. –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–æ–ª—É—á–∞–ª–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤–æ–∑–≤—Ä–∞—Ç–µ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞
**–†–µ—à–µ–Ω–∏–µ**:
- ‚úÖ URL —Å—Ö–µ–º–∞ `app://comeback` –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ AndroidManifest.xml
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `CheckDeepLinkOnFocus()` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–ª—É–±–æ–∫–∏—Ö —Å—Å—ã–ª–æ–∫
- ‚úÖ –£–ª—É—á—à–µ–Ω –º–µ—Ç–æ–¥ `OnApplicationFocus()` –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞

### 3. –ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏–ª–∏ –¥–æ–ª–≥–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏
**–†–µ—à–µ–Ω–∏–µ**:
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (`OnPaymentSuccess`, `OnPaymentFailed`, `OnPaymentPending`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- ‚úÖ –¢–∞–π–º–∞—É—Ç 5 –º–∏–Ω—É—Ç –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã API endpoints
**–ë—ã–ª–æ**: `https://api.freedompay.uz/api/v1/payment/create`
**–°—Ç–∞–ª–æ**: `https://api.freedompay.money/payment/create`

## üéÆ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ü–µ–Ω—ã

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:
```
Scene "1.unity"
‚îú‚îÄ‚îÄ PaymentSystemManager          # –û—Å–Ω–æ–≤–Ω–æ–π –º–µ–Ω–µ–¥–∂–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ FreedomPayManager         # –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îî‚îÄ‚îÄ SimplePaymentTest         # –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ Canvas                        # UI —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îî‚îÄ‚îÄ PaymentTestPanel          # –ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
‚îÇ       ‚îú‚îÄ‚îÄ PayButton             # –ö–Ω–æ–ø–∫–∞ –æ–ø–ª–∞—Ç—ã
‚îÇ       ‚îî‚îÄ‚îÄ StatusDisplay         # –°—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–π
```

### –û—á–∏—â–µ–Ω—ã –Ω–µ–Ω—É–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:
- ‚ùå –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –æ–±—ä–µ–∫—Ç—ã
- ‚ùå –£–±—Ä–∞–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–µ–∑ —Å–≤—è–∑–µ–π
- ‚ùå –û—á–∏—â–µ–Ω–∞ —Å—Ü–µ–Ω–∞ –æ—Ç –º—É—Å–æ—Ä–∞

## üöÄ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### 1. –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞
```csharp
FreedomPayManager.Instance.InitiatePayment(amount, orderId, description);
```

### 2. –ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã
1. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞** ‚Üí API –∑–∞–ø—Ä–æ—Å –Ω–∞ `/payment/create`
2. **–û—Ç–∫—Ä—ã—Ç–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞** ‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã
3. **–û–ø–ª–∞—Ç–∞** ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. **–í–æ–∑–≤—Ä–∞—Ç** ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç –ø–æ —Å—Ö–µ–º–µ `app://comeback`
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞** ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
6. **–†–µ–∑—É–ª—å—Ç–∞—Ç** ‚Üí –°–æ–±—ã—Ç–∏—è `OnPaymentSuccess`/`OnPaymentFailed`

### 3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
```csharp
// –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ:
PlayerPrefs.SetString("LastPaymentTime", DateTime.Now.ToBinary().ToString());
PlayerPrefs.SetInt("PaidAmount", amount);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (30 –º–∏–Ω—É—Ç):
if (timeSincePayment.TotalMinutes < 30) {
    // –ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞
}
```

## üîê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Production)

```csharp
Merchant ID: 552170
Secret Key Receive: wUQ18x3bzP86MUzn
API Base URL: https://api.freedompay.money
Return URL: app://comeback
```

## üì± Android –º–∞–Ω–∏—Ñ–µ—Å—Ç (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

```xml
<intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE" />
    <data android:scheme="app" android:host="comeback" />
</intent-filter>
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
1. –û—Ç–∫—Ä—ã—Ç—å —Å—Ü–µ–Ω—É `1.unity`
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å Play Mode
3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–û–ø–ª–∞—Ç–∏—Ç—å 1000 —Å—É–º"
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ Console

### 2. –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
- ‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞ —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –ø–ª–∞—Ç–µ–∂–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ 30-–º–∏–Ω—É—Ç–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏

### 3. –û—Ç–ª–∞–¥–∫–∞
- **Context Menu** ‚Üí "Clear Payment Data" –¥–ª—è –æ—á–∏—Å—Ç–∫–∏
- **Context Menu** ‚Üí "Test Browser Open" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- **Console** ‚Üí –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –°–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API `https://api.freedompay.money`
- –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### URL —Å—Ö–µ–º—ã
- Android: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ AndroidManifest.xml
- iOS: –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ URL Types –≤ Info.plist

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- –í Unity Editor –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Application.OpenURL()`
- –ù–∞ Android –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Intent —Å–∏—Å—Ç–µ–º–∞
- –ù–∞ iOS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `Application.OpenURL()`

## üéØ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### –î–æ–±–∞–≤–∏—Ç—å –≤ VideoSpawner.cs:
```csharp
void Update() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º AR –æ–±—ä–µ–∫—Ç–æ–≤
    if (HasActiveSubscription()) {
        ShowARObjects();
    } else {
        ShowPaymentUI();
    }
}

bool HasActiveSubscription() {
    string lastPaymentTime = PlayerPrefs.GetString("LastPaymentTime", "");
    if (string.IsNullOrEmpty(lastPaymentTime)) return false;
    
    long timeBinary = System.Convert.ToInt64(lastPaymentTime);
    DateTime payTime = DateTime.FromBinary(timeBinary);
    return (DateTime.Now - payTime).TotalMinutes < 30;
}
```

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ  
**–í–µ—Ä—Å–∏—è**: 3.0 Production Fixed  
**–î–∞—Ç–∞**: 2025-01-08 